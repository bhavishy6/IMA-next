{"version":3,"file":"static/webpack/static\\development\\pages\\index.js.610fe07118263ee9290e.hot-update.js","sources":["webpack:///./pages/index.js"],"sourcesContent":["import IMALayout from '../components/IMALayout'\r\nimport IMARecentSalesChart from '../components/IMARecentSalesChart'\r\nimport fetch from 'isomorphic-unfetch'\r\nimport IMANewSaleForm from '../components/forms/IMANewSaleForm';\r\n\r\nvar moment = require('moment')\r\nmoment().format('L');\r\n\r\nconst Dashboard = props => {\r\n    return (\r\n        <IMALayout>\r\n            <div >\r\n                form to add new sale\r\n                form to add new customer\r\n                form to add new inventory item1\r\n            <p>recent sales since 30 days ago: {JSON.stringify(props.recentSalesByDateDict)}</p>\r\n                <div style={{ height: 500 + \"px\", width: 500 + 'px' }}>\r\n                    <IMARecentSalesChart data={getMostRecentSalesNIVO(props.recentSalesByDateDict)} />\r\n                </div>\r\n            </div>\r\n\r\n            <IMANewSaleForm productList={['Iron Sheet', 'Copper Sheet']} />\r\n        </IMALayout>\r\n    )\r\n\r\n};\r\n\r\nDashboard.getInitialProps = async ctx => {\r\n    const res = await fetch('http://localhost:3000/api/sales?daysAgo=' + 30)\r\n    const json = await res.json()\r\n    console.log(`Show data fetched. ${JSON.stringify(json)}`);\r\n    var mostRecentSales = getMostRecentSalesDict(json)\r\n    console.log(JSON.stringify(mostRecentSales[0]))\r\n    return { recentSalesByDateDict: mostRecentSales };\r\n}\r\n\r\nfunction getMostRecentSalesDict(sales) {\r\n    var recentSales = {}\r\n    sales.forEach((sale, index) => {\r\n        console.log(index + \":\" + sale[\"date\"])\r\n        var date = moment(sale[\"date\"]).format(\"L\")\r\n        var quantities = sale[\"quantities\"]\r\n        // console.log(JSON.stringify(quantities))\r\n        if (recentSales[date]) {\r\n            console.log('this date exists' + date)\r\n            recentSales[date].forEach((product, index) => {\r\n                // console.log(\"existing product name for this day: \" + product['name'])\r\n                var sameProduct = findProductInQuantities(product[\"name\"], quantities)\r\n                console.log(JSON.stringify(sameProduct))\r\n                if (sameProduct === null) {\r\n\r\n                } else {\r\n                    // console.log(\"found same product: \" + JSON.stringify(product) + product['qty'] +\"+\\n \" + JSON.stringify(sameProduct))\r\n                    product[\"qty\"] += sameProduct[\"qty\"]\r\n                }\r\n            }, recentSales[date])\r\n        } else {\r\n            //this date does not yet exist in recentSales\r\n            recentSales[date] = sale[\"quantities\"]\r\n        }\r\n    })\r\n    console.log(\"map:  \" + JSON.stringify(recentSales) + \"232323\")\r\n    return recentSales;\r\n};\r\n\r\nfunction getMostRecentSalesNIVO(recentSalesDict) {\r\n    var recentSales = []\r\n    Object.keys(recentSalesDict).forEach(function(date, index) {\r\n        var salesOnDate = recentSalesDict[date]\r\n        recentSales.push({})\r\n        recentSales[index]['date']=date\r\n        for (var i = 0; i < salesOnDate.length; i++) {\r\n            recentSales[index][salesOnDate[i]['name']] = salesOnDate[i]['qty']\r\n            switch(salesOnDate[i]['name']) {\r\n                case 'Iron Sheet':\r\n                    recentSales[index]['Iron SheetColor'] = \"hsl(129, 70%, 50%)\";\r\n                    break;\r\n                case 'Copper Sheet':\r\n                    recentSales[index]['Copper SheetColor'] = \"hsl(77, 70%, 50%)\";\r\n                    break;\r\n            }\r\n        }\r\n     });\r\n     console.log(\"recentNIVO: \" + JSON.stringify(recentSales))\r\n    return recentSales;\r\n}\r\n\r\nfunction findProductInQuantities(name, quantities) {\r\n    var foundProduct = null;\r\n    quantities.forEach((product, index) => {\r\n        console.log(name + \"checking product name: \" + product['name'])\r\n        if (name == product['name']) {\r\n            console.log('true' + JSON.stringify(product))\r\n            foundProduct = product;\r\n        }\r\n    });\r\n    return foundProduct;\r\n}\r\n\r\nexport default Dashboard;"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AADA;AAAA;AACA;AADA;AAEA;AACA;AACA;AACA;AALA;AAMA;AAAA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAQA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AANA;AAQA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;A","sourceRoot":""}