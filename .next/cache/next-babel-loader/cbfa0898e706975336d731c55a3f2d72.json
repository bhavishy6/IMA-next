{"ast":null,"code":"import nextConnect from 'next-connect';\nimport middleware from '../../middleware/database';\n\nvar moment = require('moment');\n\nmoment().format('L');\nconst handler = nextConnect();\nhandler.use(middleware);\nhandler.get(async (req, res) => {\n  const {\n    daysAgo\n  } = req.query; // console.log(this.state);\n\n  var startDateExists = true;\n  var dbQuery = {};\n\n  if (startDateExists) {\n    var startDateFilter = moment().subtract(daysAgo, 'days');\n    dbQuery = {\n      \"date\": {\n        $gte: new Date(startDateFilter._d)\n      }\n    };\n  }\n\n  let doc = await req.db.collection('sales').find(dbQuery).toArray();\n  console.log(doc);\n  res.json(doc);\n  res.end();\n});\nexport default handler;","map":null,"metadata":{},"sourceType":"module"}