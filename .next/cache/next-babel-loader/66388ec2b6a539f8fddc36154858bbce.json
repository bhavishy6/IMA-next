{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\bhavi\\\\Documents\\\\Coding\\\\IMA-next\\\\pages\\\\index.js\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport IMALayout from '../components/IMALayout';\nimport IMARecentSalesChart from '../components/IMARecentSalesChart';\nimport fetch from 'isomorphic-unfetch';\nimport IMANewSaleForm from '../components/forms/IMANewSaleForm';\nimport { Component } from 'react';\n\nvar moment = require('moment');\n\nmoment().format('L');\n\nclass Dashboard extends Component {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", {\n      productList: [],\n      recentSalesByDateDict: [],\n      isLoading: true\n    });\n  }\n\n  async fetchInventory() {\n    const inventory = await fetch('http://localhost:3000/api/inventory');\n    const inventoryjson = await inventory.json();\n    return inventoryjson;\n  }\n\n  async fetchRecentSales(daysAgo) {\n    const sales = await fetch('http://localhost:3000/api/sales?daysAgo=' + daysAgo);\n    const salesjson = await sales.json();\n    return salesjson;\n  }\n\n  async componentDidMount() {\n    var salesDict = [];\n\n    var _asyncMostRecentSales = this.fetchRecentSales(30).then(externalData => {\n      salesDict = getMostRecentSalesDict(externalData);\n      salesDict = getMostRecentSalesNIVO(salesDict);\n    });\n\n    var productList = [];\n\n    var _asyncInventory = this.fetchInventory().then(externalData => {\n      productList = inventoryjson;\n    });\n\n    this.setState({\n      productList: productList,\n      recentSalesByDateDict: salesDict,\n      isLoading: false\n    });\n  }\n\n  getMostRecentSalesDict(sales) {\n    console.log(\"mrd\" + JSON.stringify(sales));\n    var recentSales = {};\n    sales.forEach((sale, index) => {\n      var date = moment(sale[\"date\"]).format(\"L\");\n      console.log(\"checking dateL : \" + date);\n      var quantities = sale[\"quantities\"];\n\n      if (recentSales[date]) {\n        console.log('this date exists' + date);\n        recentSales[date].forEach((product, index) => {\n          var sameProduct = findProductInQuantities(product[\"name\"], quantities);\n\n          if (sameProduct === null) {} else {\n            product[\"qty\"] += sameProduct[\"qty\"];\n          }\n        }, recentSales[date]);\n      } else {\n        //this date does not yet exist in recentSales\n        recentSales[date] = sale[\"quantities\"];\n      }\n    });\n    console.log(JSON.stringify(recentSales));\n    return recentSales;\n  }\n\n  getMostRecentSalesNIVO(recentSalesDict) {\n    console.log(\"nivo\" + JSON.stringify(recentSalesDict));\n    var recentSales = [];\n    Object.keys(recentSalesDict).forEach(function (date, index) {\n      var salesOnDate = recentSalesDict[date];\n      recentSales.push({});\n      recentSales[index]['date'] = date;\n\n      for (var i = 0; i < salesOnDate.length; i++) {\n        recentSales[index][salesOnDate[i]['name']] = salesOnDate[i]['qty'];\n\n        switch (salesOnDate[i]['name']) {\n          case 'Iron Sheet':\n            recentSales[index]['Iron SheetColor'] = \"hsl(129, 70%, 50%)\";\n            break;\n\n          case 'Copper Sheet':\n            recentSales[index]['Copper SheetColor'] = \"hsl(77, 70%, 50%)\";\n            break;\n\n          case 'Free Product':\n            recentSales[index]['Free ProductColor'] = \"hsl(150, 70%, 50%)\";\n            break;\n        }\n      }\n    });\n    this.setState({\n      'recentSalesLoaded': true\n    });\n    return recentSales;\n  }\n\n  findProductInQuantities(name, quantities) {\n    var foundProduct = null;\n    quantities.forEach((product, index) => {\n      console.log(name + \"checking product name: \" + product['name']);\n\n      if (name == product['name']) {\n        foundProduct = product;\n      }\n    });\n    return foundProduct;\n  }\n\n  render() {\n    return __jsx(IMALayout, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, __jsx(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }, \"form to add new sale form to add new customer form to add new inventory item1\", __jsx(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, \"recent sales since 30 days ago: \", JSON.stringify(this.state.recentSalesByDateDict)), __jsx(\"div\", {\n      style: {\n        height: 500 + \"px\",\n        width: 500 + 'px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, __jsx(IMARecentSalesChart, {\n      data: this.state.recentSalesByDateDict,\n      isLoaded: this.state.isLoading,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }))), __jsx(IMANewSaleForm, {\n      productList: this.state.productList,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }));\n  }\n\n}\n\nexport default Dashboard;","map":{"version":3,"sources":["C:/Users/bhavi/Documents/Coding/IMA-next/pages/index.js"],"names":["IMALayout","IMARecentSalesChart","fetch","IMANewSaleForm","Component","moment","require","format","Dashboard","productList","recentSalesByDateDict","isLoading","fetchInventory","inventory","inventoryjson","json","fetchRecentSales","daysAgo","sales","salesjson","componentDidMount","salesDict","_asyncMostRecentSales","then","externalData","getMostRecentSalesDict","getMostRecentSalesNIVO","_asyncInventory","setState","console","log","JSON","stringify","recentSales","forEach","sale","index","date","quantities","product","sameProduct","findProductInQuantities","recentSalesDict","Object","keys","salesOnDate","push","i","length","name","foundProduct","render","state","height","width"],"mappings":"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","sourcesContent":["import IMALayout from '../components/IMALayout'\r\nimport IMARecentSalesChart from '../components/IMARecentSalesChart'\r\nimport fetch from 'isomorphic-unfetch'\r\nimport IMANewSaleForm from '../components/forms/IMANewSaleForm';\r\nimport { Component } from 'react';\r\n\r\nvar moment = require('moment')\r\nmoment().format('L');\r\n\r\nclass Dashboard extends Component {\r\n    state = {\r\n        productList: [],\r\n        recentSalesByDateDict: [],\r\n        isLoading: true\r\n    }\r\n    \r\n\r\n    async fetchInventory () {\r\n        const inventory = await fetch('http://localhost:3000/api/inventory')\r\n        const inventoryjson = await inventory.json()\r\n        return inventoryjson;\r\n    }\r\n\r\n    async fetchRecentSales (daysAgo) {\r\n        const sales = await fetch('http://localhost:3000/api/sales?daysAgo=' + daysAgo)\r\n        const salesjson = await sales.json()\r\n        return salesjson;\r\n    }\r\n    async componentDidMount() {\r\n        var salesDict = []\r\n        var _asyncMostRecentSales = this.fetchRecentSales(30).then(externalData => {\r\n            salesDict = getMostRecentSalesDict(externalData);\r\n            salesDict = getMostRecentSalesNIVO(salesDict);\r\n        })\r\n\r\n        var productList = []\r\n        var _asyncInventory = this.fetchInventory().then(externalData => {\r\n            productList = inventoryjson;\r\n        });\r\n\r\n        this.setState({\r\n            productList: productList,\r\n            recentSalesByDateDict: salesDict,\r\n            isLoading: false\r\n        });\r\n    }\r\n\r\n    getMostRecentSalesDict(sales) {\r\n        console.log(\"mrd\" + JSON.stringify(sales))\r\n        var recentSales = {}\r\n        sales.forEach((sale, index) => {\r\n            var date = moment(sale[\"date\"]).format(\"L\")\r\n            console.log(\"checking dateL : \" + date)\r\n            var quantities = sale[\"quantities\"]\r\n            if (recentSales[date]) {\r\n                console.log('this date exists' + date)\r\n                recentSales[date].forEach((product, index) => {\r\n                    var sameProduct = findProductInQuantities(product[\"name\"], quantities)\r\n                    if (sameProduct === null) {\r\n\r\n                    } else {\r\n                        product[\"qty\"] += sameProduct[\"qty\"]\r\n                    }\r\n                }, recentSales[date])\r\n            } else {\r\n                //this date does not yet exist in recentSales\r\n                recentSales[date] = sale[\"quantities\"]\r\n            }\r\n        })\r\n        console.log(JSON.stringify(recentSales))\r\n        return recentSales;\r\n    };\r\n\r\n    getMostRecentSalesNIVO(recentSalesDict) {\r\n        console.log(\"nivo\" + JSON.stringify(recentSalesDict))\r\n        var recentSales = []\r\n        Object.keys(recentSalesDict).forEach(function (date, index) {\r\n            var salesOnDate = recentSalesDict[date]\r\n            recentSales.push({})\r\n            recentSales[index]['date'] = date\r\n            for (var i = 0; i < salesOnDate.length; i++) {\r\n                recentSales[index][salesOnDate[i]['name']] = salesOnDate[i]['qty']\r\n                switch (salesOnDate[i]['name']) {\r\n                    case 'Iron Sheet':\r\n                        recentSales[index]['Iron SheetColor'] = \"hsl(129, 70%, 50%)\";\r\n                        break;\r\n                    case 'Copper Sheet':\r\n                        recentSales[index]['Copper SheetColor'] = \"hsl(77, 70%, 50%)\";\r\n                        break;\r\n                    case 'Free Product':\r\n                        recentSales[index]['Free ProductColor'] = \"hsl(150, 70%, 50%)\";\r\n                        break;\r\n                }\r\n            }\r\n        });\r\n        this.setState({'recentSalesLoaded': true});\r\n        return recentSales;\r\n    }\r\n\r\n    findProductInQuantities(name, quantities) {\r\n        var foundProduct = null;\r\n        quantities.forEach((product, index) => {\r\n            console.log(name + \"checking product name: \" + product['name'])\r\n            if (name == product['name']) {\r\n                foundProduct = product;\r\n            }\r\n        });\r\n        return foundProduct;\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <IMALayout>\r\n                <div >\r\n                    form to add new sale\r\n                    form to add new customer\r\n                    form to add new inventory item1\r\n                <p>recent sales since 30 days ago: {JSON.stringify(this.state.recentSalesByDateDict)}</p>\r\n\r\n                    <div style={{ height: 500 + \"px\", width: 500 + 'px' }}>\r\n                        <IMARecentSalesChart data={this.state.recentSalesByDateDict} isLoaded={this.state.isLoading} />\r\n                    </div>\r\n\r\n                </div>\r\n\r\n                <IMANewSaleForm productList={this.state.productList} />\r\n            </IMALayout>\r\n\r\n\r\n        )\r\n\r\n    }\r\n}\r\n\r\nexport default Dashboard;"]},"metadata":{},"sourceType":"module"}